<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>アンケート | ARスタンプラリー</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="color-scheme" content="light" />
  <link rel="stylesheet" href="css/style.css" />
  <style>
    :root{
      --accent:#005ABB;
      --bg:#ffffff;
      --text:#111111;
      --muted:#666;
      --error:#c1121f;
      --gap:18px;
      --radius:14px;
      --container: 600px;
    }
    html,body{background:var(--bg); color:var(--text); margin:0; padding:0}
    body{font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;-webkit-text-size-adjust:100%;line-height:1.6;}
    .wrap{max-width:var(--container);margin:0 auto;padding: clamp(16px, 4vw, 24px);padding-bottom: max(24px, env(safe-area-inset-bottom));}
    header{ position:sticky; top:0; z-index:5; background:var(--bg); padding-bottom:12px; }
    h1{ font-size: clamp(20px, 4.8vw, 22px); margin:0 0 6px; color:var(--accent); font-weight:800; letter-spacing:.01em; }
    .section{margin-top: clamp(14px, 3.5vw, 18px);border:1px solid #e9eef6; border-radius: var(--radius);padding: clamp(14px, 3.6vw, 18px);box-shadow: 0 6px 24px rgba(0,0,0,.04);background:#fff;}
    .section + .section{ margin-top: clamp(24px, 6vw, 36px); }
    .sec-title{ margin:0 0 8px; font-size: clamp(16px, 4.4vw, 18px); font-weight:800; }
    .field{ margin-top: var(--gap) }
    .label-row{ display:flex; align-items: baseline; gap:8px; flex-wrap:wrap; margin-bottom:6px; }
    .label-row label{ font-weight:700 }
    .req{ color:#c1121f; font-size:12px; font-weight:700; }
    .hint{ color:#666; font-size:12px; margin-bottom:8px }
    .note{ color:#444; font-size:13px; background:#f7f9fe; border:1px solid #e9eef6; border-radius:10px; padding:10px; }
    .age-row{ display:flex; align-items:center; gap:10px; }
    .age-input{ width:140px; max-width:42vw; appearance:textfield; font-size:18px; padding:12px 12px; border-radius:12px; border:1px solid #d7deea; background:#fff; }
    .age-suffix{ font-size:16px }
    .likert{ display:grid; grid-template-columns: repeat(5,1fr); gap:8px; }
    .radio-pill{ display:flex; align-items:center; justify-content:center; border:1.5px solid #d7deea; border-radius:12px; padding:10px 6px; font-weight:700; user-select:none; cursor:pointer; transition: border-color .15s, background .15s; font-size:14px; text-align:center; }
    .radio-pill input{ display:none }
    .radio-pill.is-active{ border-color:var(--accent); background:#eef5ff }
    .likert-scale{ display:flex; justify-content:space-between; color:#333; font-size:12px; margin-top:6px }
    .yn{ display:grid; grid-template-columns: repeat(2,1fr); gap:8px }
    .text-input, .textarea{ width:100%; border:1px solid #d7deea; border-radius:12px; background:#fff; padding:12px 12px; font-size:16px; }
    .textarea{ min-height:120px; resize:vertical }
    .err{ color:#c1121f; font-size:12px; margin-top:6px; display:none }
    .footer{ position:sticky; bottom:0; z-index:10; margin-top: clamp(18px, 4.5vw, 24px); background: linear-gradient(to top, #fff, #fff 60%, rgba(255,255,255,0)); padding-top: 12px; }
    .btn{ appearance:none; border:0; width:100%; border-radius:14px; padding:16px 20px; font-weight:900; letter-spacing:.02em; background:var(--accent); color:#fff; font-size:18px; box-shadow:0 10px 30px rgba(0,90,187,.25); cursor:pointer; }
    .btn[aria-busy="true"]{ opacity:.7; pointer-events:none }
    button, label{ -webkit-tap-highlight-color: rgba(0,0,0,0) }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>アンケート</h1>
    </header>

    <form id="surveyForm" novalidate>
      <!-- あなたについて -->
      <section class="section" aria-labelledby="aboutYou">
        <h2 class="sec-title" id="aboutYou">あなたについて</h2>

        <!-- 年代（必須） -->
        <div class="field" id="f-age">
          <div class="label-row">
            <label for="age">年代</label><span class="req">*必須</span>
          </div>
          <div class="hint">半角数字で入力</div>
          <div class="age-row">
            <input id="age" name="age" class="age-input" type="tel" inputmode="numeric" pattern="[0-9]*" placeholder="18" aria-describedby="ageErr" />
            <span class="age-suffix">歳</span>
          </div>
          <div class="err" id="ageErr">年代（年齢）を半角数字で入力してください。</div>
        </div>

        <!-- 歴史に興味（必須） -->
        <div class="field" id="f-histInterest">
          <div class="label-row"><label>歴史に興味があるか</label><span class="req">*必須</span></div>
          <div class="likert" data-name="hist_interest" role="radiogroup" aria-describedby="histInterestScale histInterestErr">
            <label class="radio-pill"><input type="radio" name="hist_interest" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="hist_interest" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="hist_interest" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="hist_interest" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="hist_interest" value="5"><span>5</span></label>
          </div>
          <div class="likert-scale" id="histInterestScale"><span>そう思わない</span><span>そう思う</span></div>
          <div class="err" id="histInterestErr">1〜5のいずれかを選択してください。</div>
        </div>

        <!-- 歴史資料の保存への関心（必須） -->
        <div class="field" id="f-presInterest">
          <div class="label-row"><label>歴史資料の保存に関心があるか</label><span class="req">*必須</span></div>
          <div class="likert" data-name="preservation_interest" role="radiogroup" aria-describedby="presInterestScale presInterestErr">
            <label class="radio-pill"><input type="radio" name="preservation_interest" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="preservation_interest" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="preservation_interest" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="preservation_interest" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="preservation_interest" value="5"><span>5</span></label>
          </div>
          <div class="likert-scale" id="presInterestScale"><span>そう思わない</span><span>そう思う</span></div>
          <div class="err" id="presInterestErr">1〜5のいずれかを選択してください。</div>
        </div>

        <!-- 自主的に調べた経験（必須） -->
        <div class="field" id="f-selfResearch">
          <div class="label-row"><label>興味を持った歴史の事柄について、自主的に調べたことがあるか</label><span class="req">*必須</span></div>
          <div class="likert" data-name="self_research" role="radiogroup" aria-describedby="selfResearchScale selfResearchErr">
            <label class="radio-pill"><input type="radio" name="self_research" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="self_research" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="self_research" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="self_research" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="self_research" value="5"><span>5</span></label>
          </div>
          <div class="likert-scale" id="selfResearchScale"><span>そう思わない</span><span>そう思う</span></div>
          <div class="err" id="selfResearchErr">1〜5のいずれかを選択してください。</div>
        </div>

        <!-- アプリで歴史への興味の変化（必須） -->
        <div class="field" id="f-histChange">
          <div class="label-row"><label>本アプリを通して、歴史への興味に変化はあったか</label><span class="req">*必須</span></div>
          <div class="likert" data-name="hist_change" role="radiogroup" aria-describedby="histChangeScale histChangeErr">
            <label class="radio-pill"><input type="radio" name="hist_change" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="hist_change" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="hist_change" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="hist_change" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="hist_change" value="5"><span>5</span></label>
          </div>
          <div class="likert-scale" id="histChangeScale"><span>そう思わない</span><span>そう思う</span></div>
          <div class="err" id="histChangeErr">1〜5のいずれかを選択してください。</div>
        </div>

        <!-- アプリで保存への関心の変化（必須） -->
        <div class="field" id="f-presChange">
          <div class="label-row"><label>本アプリを通して、歴史資料の保存の関心に変化はあったか</label><span class="req">*必須</span></div>
          <div class="likert" data-name="preservation_change" role="radiogroup" aria-describedby="presChangeScale presChangeErr">
            <label class="radio-pill"><input type="radio" name="preservation_change" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="preservation_change" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="preservation_change" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="preservation_change" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="preservation_change" value="5"><span>5</span></label>
          </div>
          <div class="likert-scale" id="presChangeScale"><span>そう思わない</span><span>そう思う</span></div>
          <div class="err" id="presChangeErr">1〜5のいずれかを選択してください。</div>
        </div>
      </section>

      <!-- ICU在学生・教職員の方へ（任意・統合セクション） -->
      <section class="section" aria-labelledby="forICU">
        <h2 class="sec-title" id="forICU">ICU在学生・教職員の方へ（任意回答）</h2>
        <p class="note">該当しない方・回答を希望しない方は、このセクションは空欄で構いません。</p>

        <!-- パネル展示の認知 -->
        <div class="field">
          <div class="label-row"><label>ICU内の歴史関係の組織・展示について：パネル展示（例：本館173教室前）を知っていたか</label></div>
          <div class="likert" data-name="panel_awareness">
            <label class="radio-pill"><input type="radio" name="panel_awareness" value="1"><span>知らない</span></label>
            <label class="radio-pill"><input type="radio" name="panel_awareness" value="2"><span>見かけたことがある</span></label>
            <label class="radio-pill"><input type="radio" name="panel_awareness" value="3"><span>軽く見たことがある</span></label>
            <label class="radio-pill"><input type="radio" name="panel_awareness" value="4"><span>読んだことがある</span></label>
            <label class="radio-pill"><input type="radio" name="panel_awareness" value="5"><span>じっくり読んだことがある</span></label>
          </div>
        </div>

        <!-- パネル展示への関心 -->
        <div class="field">
          <div class="label-row"><label>本アプリを通して、パネル展示への関心が高まったか</label></div>
          <div class="likert" data-name="panel_interest">
            <label class="radio-pill"><input type="radio" name="panel_interest" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="panel_interest" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="panel_interest" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="panel_interest" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="panel_interest" value="5"><span>5</span></label>
          </div>
        </div>

        <!-- アーカイブズの説明 -->
        <p class="note">本アプリの写真や解説は、ICUアーカイブズ（ICUの歴史に関する資料や記録の保存・収集・提供を行う組織。図書館1階に展示室、2階に分室）にご協力いただき提供されています。</p>

        <!-- アーカイブズ認知 -->
        <div class="field">
          <div class="label-row"><label>ICUアーカイブズのことを知っていたか</label></div>
          <div class="likert" data-name="archives_awareness">
            <label class="radio-pill"><input type="radio" name="archives_awareness" value="1"><span>知らない</span></label>
            <label class="radio-pill"><input type="radio" name="archives_awareness" value="2"><span>見かけたことがある</span></label>
            <label class="radio-pill"><input type="radio" name="archives_awareness" value="3"><span>存在を知っている</span></label>
            <label class="radio-pill"><input type="radio" name="archives_awareness" value="4"><span>どういう組織か軽く知っている</span></label>
            <label class="radio-pill"><input type="radio" name="archives_awareness" value="5"><span>どういう組織か詳しく知っている</span></label>
          </div>
        </div>

        <!-- アーカイブズ訪問 -->
        <div class="field">
          <div class="label-row"><label>ICUアーカイブズを訪問したことがあるか</label></div>
          <div class="yn" data-name="archives_visited">
            <label class="radio-pill"><input type="radio" name="archives_visited" value="yes"><span>はい</span></label>
            <label class="radio-pill"><input type="radio" name="archives_visited" value="no"><span>いいえ</span></label>
          </div>
        </div>

        <!-- アーカイブズへの関心 -->
        <div class="field">
          <div class="label-row"><label>本アプリにより、ICUアーカイブズへの関心が高まったか</label></div>
          <div class="likert" data-name="archives_interest">
            <label class="radio-pill"><input type="radio" name="archives_interest" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="archives_interest" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="archives_interest" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="archives_interest" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="archives_interest" value="5"><span>5</span></label>
          </div>
        </div>
      </section>

      <!-- アプリについて（必須2問） -->
      <section class="section" aria-labelledby="aboutApp">
        <h2 class="sec-title" id="aboutApp">アプリについて</h2>

        <div class="field" id="f-fun">
          <div class="label-row"><label>面白かったか</label><span class="req">*必須</span></div>
          <div class="likert" data-name="fun" role="radiogroup" aria-describedby="funScale funErr">
            <label class="radio-pill"><input type="radio" name="fun" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="fun" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="fun" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="fun" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="fun" value="5"><span>5</span></label>
          </div>
          <div class="likert-scale" id="funScale"><span>そう思わない</span><span>そう思う</span></div>
          <div class="err" id="funErr">1〜5のいずれかを選択してください。</div>
        </div>

        <div class="field" id="f-usability">
          <div class="label-row"><label>使いやすかったか</label><span class="req">*必須</span></div>
          <div class="likert" data-name="usability" role="radiogroup" aria-describedby="usabilityScale usabilityErr">
            <label class="radio-pill"><input type="radio" name="usability" value="1"><span>1</span></label>
            <label class="radio-pill"><input type="radio" name="usability" value="2"><span>2</span></label>
            <label class="radio-pill"><input type="radio" name="usability" value="3"><span>3</span></label>
            <label class="radio-pill"><input type="radio" name="usability" value="4"><span>4</span></label>
            <label class="radio-pill"><input type="radio" name="usability" value="5"><span>5</span></label>
          </div>
          <div class="likert-scale" id="usabilityScale"><span>そう思わない</span><span>そう思う</span></div>
          <div class="err" id="usabilityErr">1〜5のいずれかを選択してください。</div>
        </div>
      </section>

      <!-- 自由記述（任意） -->
      <section class="section" aria-labelledby="free">
        <h2 class="sec-title" id="free">自由記述欄（任意）</h2>
        <div class="field">
          <div class="label-row"><label for="free_text">ご意見・ご感想など</label></div>
          <textarea id="free_text" name="free_text" class="textarea" placeholder="ご自由にお書きください（任意）"></textarea>
        </div>
      </section>

      <div class="footer">
        <button id="submitSurveyBtn" type="button" class="btn" aria-busy="false">アンケート送信</button>
      </div>
    </form>
  </div>

  <script src="js/firebase.js" defer></script>
  <script src="js/post-survey.js?v=20251010-merge" defer></script>
</body>
</html>
